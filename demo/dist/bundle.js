!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={keyTypeArray:/\[\s*(\d+)\s*\]+/g,params:/\{\s*(\d+)\s*\}+/g,splitQuery:/\s+in\s+/,findTemplateVars:/\{\{\s*([\[\]\$\.\_0-9a-zA-Z]+)\s*\}\}/g,splitQueryVars:/\s*,\s*/,isArraySintax:{ini:/(?=^\s*\[)/,end:/(?=\]\s*$)/},filters:{like:/\s+like\s+/,as:/\s+as\s+/},hasSelectorCss:/^(#|\.)\S/}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return RepeatHtml});var _patterns__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),RepeatHtml=function(){function e(e){void 0===e&&(e={}),this.REPEAT_ATTR_NAME=e.attrName||"repeat",this._filters={},this._scope=e.scope||{},this._originalElements=null,this.searchFilters(),(e.compile||void 0===e.compile)&&init.call(this,!1,!1)}return e.prototype.scope=function(e,t,r){return void 0===t?this._scope[e]:(this._scope[e]=this._scope[e]||{},this._scope[e].data=t,this._scope[e].originalData=t,"function"==typeof r?this._scope[e].funcBackAfter=r:isOfType(r,"array")?(this._scope[e].funcBackAfter=r[0],this._scope[e].funcBack=r[1]):"object"==typeof r&&(this._scope[e].funcBackAfter=r.after,this._scope[e].funcBack=r.funcBack),this.refresh(e),this._scope[e].funcBackAfter&&this._scope[e].funcBackAfter.call(this,t),this)},e.prototype.filter=function(e,t,r){var n=this;if(t=t.trim(),this.validateFilter(e,t))return!1;var a=t.split(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.filters.as),i=a[0],s=a[1];s||(s=i,i=null);var l=document.getElementById(s.replace(/#|^%|%$/g,""));if(!l)return this;var o=/^%/g.test(s)?"^":"",_=/%$/g.test(s)?"$":"";return t=l.value,l.addEventListener("keyup",function(t){var a=t.target.value;n._scope[e].data=n._scope[e].originalData.filter(function(e){var t=new RegExp(o+a+_,"gi");if(i)return t.test(e[i]);for(var r in e)if(t.test(e[r]))return!0}),n.refresh(e,r)}),this},e.prototype.searchFilters=function(){var e=this,t=document.querySelectorAll("[data-filter]");if(!(t.length<=0))for(var r=null,n="",a=0;r=t[a];a++)n=r.dataset[this.REPEAT_ATTR_NAME].split(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.splitQuery),r.dataset.filter.split(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.splitQueryVars).forEach(function(t){e.filter(n[1],t,r)})},e.prototype.applyFilter=function(e){return e&&this._filters[e]?this._scope[e].data.filter(this._filters[e]):this._scope[e].data},e.prototype.validateFilter=function(e,t){return void 0!==e&&(!(!_patterns__WEBPACK_IMPORTED_MODULE_0__.a.filters.as.test(t)&&!_patterns__WEBPACK_IMPORTED_MODULE_0__.a.hasSelectorCss.test(t.replace(/^%|%$/g,"")))&&void 0)},e.prototype.refresh=function(e,t){return document.querySelectorAll("[data-"+this.REPEAT_ATTR_NAME+"]").length>0&&init.call(this,!1,!1),this.reRender(e,t),this},e.prototype.reRender=function(e,t){var r,n,a=this,i=this._originalElements,s="",l=null,o=i.length,_=document.createDocumentFragment(),c=[],u=this._scope[e];for(r=0;r<o;r++)n=i[r],t&&t.dataset.filter!==n.element.dataset.filter||(l=resolveQuery.call(this,n.element.dataset[this.REPEAT_ATTR_NAME])).datas&&e===l.varName&&(s=n.element.innerHTML,n.childs.forEach(function(e,t){0!==t&&n.parentElement.removeChild(e)}),n.childs.splice(1,n.childs.length),l.datas.forEach(function(e){var t={},r=n.elementClone.cloneNode(!1);t[l.varsIterate]=e,r.innerHTML=renderTemplate(s,t),_.appendChild(r),n.childs.push(r),u.funcBack&&c.push([e,r])}),insertAfter(_,n.childs[0]),_=document.createDocumentFragment());e&&u.funcBack&&c.forEach(function(e){u.funcBack.apply(a,e)})},e}();function init(e,t){var r,n,a=this,i="[data-"+this.REPEAT_ATTR_NAME+"]",s=document.querySelectorAll(i+(t?"":" "+i)),l=null,o=null,_=0,c=document.createDocumentFragment();this._originalElements||(this._originalElements=[]);var u=function(){if(l=s[r].element||s[r],!(o=resolveQuery.call(p,l.dataset[p.REPEAT_ATTR_NAME])).datas)return"continue";var t=l.innerHTML,n=l.cloneNode(!0),i=document.createComment("RepeatHTML: start( "+l.dataset[p.REPEAT_ATTR_NAME]+" )");n.removeAttribute("data-"+p.REPEAT_ATTR_NAME),n.removeAttribute("data-filter"),e||(p._originalElements.push({element:l.cloneNode(!0),elementClone:n,parentElement:l.parentElement,childs:[i]}),_=p._originalElements.length),c.appendChild(i),o.datas.forEach(function(r){var i,s=n.cloneNode(!1);s.innerHTML=renderTemplate(t,((i={})[o.varsIterate]=r,i)),c.appendChild(s),e||a._originalElements[_-1].childs.push(s)}),l.parentElement.replaceChild(c,l),c=document.createDocumentFragment()},p=this;for(r=0,n=s.length;r<n;r++)u();if(document.querySelectorAll(i).length>0&&!t)return init.call(this,e,!0)}function resolveQuery(e){return""!==(e=e.split(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.splitQuery))[0].trim()||e[1]?{varsIterate:e[0].split(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.splitQueryVars),datas:parseData.call(this,e[1].trim()),varName:e[1].trim()}:{varsIterate:null,datas:null,varName:null}}function renderTemplate(e,t){return e.replace(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.keyTypeArray,".$1").replace(_patterns__WEBPACK_IMPORTED_MODULE_0__.a.findTemplateVars,function(e,r){var n,a=r.split("."),i=t[a[0]];for(n=1;n<a.length;n++)i=i[a[n]];return i||e})}function parseData(strData){return this._scope[strData]?this.applyFilter(strData):_patterns__WEBPACK_IMPORTED_MODULE_0__.a.isArraySintax.ini.test(strData)&&_patterns__WEBPACK_IMPORTED_MODULE_0__.a.isArraySintax.end.test(strData)?eval(strData):null}function insertAfter(e,t){t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}function isOfType(e,t){return{}.toString.call(e).match(/\s(.+)\]$/)[1].toLowerCase()===t}},function(e,t,r){"use strict";r.r(t);var n=r(1);r.d(t,"RepeatHtml",function(){return n.a})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvcGF0dGVybnMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3JlcGVhdC1odG1sLnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImEiLCJpIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJwYXR0ZXJucyIsImtleVR5cGVBcnJheSIsInBhcmFtcyIsInNwbGl0UXVlcnkiLCJmaW5kVGVtcGxhdGVWYXJzIiwic3BsaXRRdWVyeVZhcnMiLCJpc0FycmF5U2ludGF4IiwiaW5pIiwiZW5kIiwiZmlsdGVycyIsImxpa2UiLCJhcyIsImhhc1NlbGVjdG9yQ3NzIiwiUmVwZWF0SHRtbCIsImNvbmZpZyIsInRoaXMiLCJSRVBFQVRfQVRUUl9OQU1FIiwiYXR0ck5hbWUiLCJfZmlsdGVycyIsIl9zY29wZSIsInNjb3BlIiwiX29yaWdpbmFsRWxlbWVudHMiLCJzZWFyY2hGaWx0ZXJzIiwiY29tcGlsZSIsInVuZGVmaW5lZCIsImluaXQiLCJ2YXJOYW1lIiwiZGF0YSIsImZ1bmNCYWNrcyIsIm9yaWdpbmFsRGF0YSIsImZ1bmNCYWNrQWZ0ZXIiLCJpc09mVHlwZSIsImZ1bmNCYWNrIiwiYWZ0ZXIiLCJyZWZyZXNoIiwiZmlsdGVyIiwidmFyaWFibGVOYW1lIiwiZmlsdGVyVmFsdWUiLCJlbGVtZW50IiwiX3RoaXMiLCJ0cmltIiwidmFsaWRhdGVGaWx0ZXIiLCJfZmlsdGVyIiwic3BsaXQiLCJfcGF0dGVybnNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyIsInByb3AiLCJzZWxlY3RvciIsImVsZW0iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicmVwbGFjZSIsImhhc1BlcmNlbnRJbml0IiwidGVzdCIsImhhc1BlcmNlbnRFbmQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXR0ZXJuIiwiUmVnRXhwIiwiX3Byb3AiLCJxdWVyeUZpbHRlcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwicXVlcnlSZXBlYXQiLCJkYXRhc2V0IiwiZm9yRWFjaCIsImFwcGx5RmlsdGVyIiwicmVSZW5kZXIiLCJlbGVtZW50RGF0YSIsImVsZW1lbnRzIiwiZWxlbWVudEhUTUwiLCJyZXBlYXREYXRhIiwibGVuIiwiZWxlbWVudHNSZXBlYXRDb250ZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImZ1bmNCYWNrQXJncyIsIm1vZGVsRGF0YSIsInJlc29sdmVRdWVyeSIsImRhdGFzIiwiaW5uZXJIVE1MIiwiY2hpbGRzIiwiY2hpbGQiLCJpbmRleCIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsInNwbGljZSIsIm9iakRhdGEiLCJlbGVtZW50Q2xvbmVkIiwiZWxlbWVudENsb25lIiwiY2xvbmVOb2RlIiwidmFyc0l0ZXJhdGUiLCJyZW5kZXJUZW1wbGF0ZSIsImFwcGVuZENoaWxkIiwicHVzaCIsImluc2VydEFmdGVyIiwiYXJncyIsImFwcGx5IiwiaXNSZWZyZXNoIiwiZmluZFBhcmVudHMiLCJsZW5FbGVtZW50cyIsInRoaXNfMSIsImVsZW1lbnRIdG1sIiwiZWxlbWVudENvcHkiLCJjb21tZW50U3RhcnQiLCJjcmVhdGVDb21tZW50IiwicmVtb3ZlQXR0cmlidXRlIiwiX2EiLCJyZXBsYWNlQ2hpbGQiLCJxdWVyeSIsInBhcnNlRGF0YSIsInRlbXBsYXRlIiwiZmluZCIsImtleSIsImlkeCIsInBhcnRzS2V5IiwiZmluZGVyIiwic3RyRGF0YSIsImV2YWwiLCJpbnNlcnRFbGVtZW50IiwibmV4dFNpYmxpbmciLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiY29tcGFyZSIsInRvU3RyaW5nIiwibWF0Y2giLCJ0b0xvd2VyQ2FzZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxvQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsU0FDQSxzQkFBQUcsZUFBQUMsSUFDQUQsVUFBQUgsT0FDQSxDQUNBLElBQUFLLEVBQUFMLElBQ0EsUUFBQU0sS0FBQUQsR0FBQSxpQkFBQUosZ0JBQUFGLEdBQUFPLEdBQUFELEVBQUFDLElBUEEsQ0FTQ0MsT0FBQSxXQUNELG1CQ1RBLElBQUFDLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFULFFBR0EsSUFBQUMsRUFBQU0sRUFBQUUsSUFDQUosRUFBQUksRUFDQUMsR0FBQSxFQUNBVixZQVVBLE9BTkFXLEVBQUFGLEdBQUFHLEtBQUFYLEVBQUFELFFBQUFDLElBQUFELFFBQUFRLEdBR0FQLEVBQUFTLEdBQUEsRUFHQVQsRUFBQUQsUUEyQ0EsT0F0Q0FRLEVBQUFLLEVBQUFGLEVBR0FILEVBQUFNLEVBQUFQLEVBR0FDLEVBQUFPLEVBQUEsU0FBQWYsRUFBQWdCLEVBQUFDLEdBQ0FULEVBQUFVLEVBQUFsQixFQUFBZ0IsSUFDQUcsT0FBQUMsZUFBQXBCLEVBQUFnQixHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVQsRUFBQWdCLEVBQUEsU0FBQXhCLEdBQ0FtQixPQUFBQyxlQUFBcEIsRUFBQSxjQUFpRHlCLE9BQUEsS0FJakRqQixFQUFBa0IsRUFBQSxTQUFBekIsR0FDQSxJQUFBZ0IsRUFBQWhCLEtBQUEwQixXQUNBLFdBQTJC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RCxHQUNMaUcsTUFBTSxhQUFhLEdBQ25CQyxnQkFBa0JIIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMik7XG4iLCJleHBvcnQgY29uc3QgcGF0dGVybnMgPSB7XG4gICAga2V5VHlwZUFycmF5OiAvXFxbXFxzKihcXGQrKVxccypcXF0rL2csXG4gICAgcGFyYW1zOiAvXFx7XFxzKihcXGQrKVxccypcXH0rL2csXG4gICAgc3BsaXRRdWVyeTogL1xccytpblxccysvLFxuICAgIGZpbmRUZW1wbGF0ZVZhcnM6IC9cXHtcXHtcXHMqKFtcXFtcXF1cXCRcXC5cXF8wLTlhLXpBLVpdKylcXHMqXFx9XFx9L2csXG4gICAgc3BsaXRRdWVyeVZhcnM6IC9cXHMqLFxccyovLFxuICAgIGlzQXJyYXlTaW50YXg6IHtcbiAgICAgICAgaW5pOiAvKD89XlxccypcXFspLyxcbiAgICAgICAgZW5kOiAvKD89XFxdXFxzKiQpL1xuICAgIH0sXG4gICAgZmlsdGVyczoge1xuICAgICAgICBsaWtlOiAvXFxzK2xpa2VcXHMrLyxcbiAgICAgICAgYXM6IC9cXHMrYXNcXHMrL1xuICAgIH0sXG4gICAgaGFzU2VsZWN0b3JDc3M6IC9eKCN8XFwuKVxcUy9cbn07XG4iLCJpbXBvcnQgeyBwYXR0ZXJucyB9IGZyb20gJy4vcGF0dGVybnMnO1xuXG5kZWNsYXJlIGxldCBkb2N1bWVudDtcblxuLyoqXG4gKiBAY29uc3RydWN0b3IgUmVwZWF0SFRNTFxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyAtIENvbmZpZ3VyYWNpb24gaW5pY2lhbCBwYXJhIGxhIGluc3RhbmNpYVxuICovXG5leHBvcnQgY2xhc3MgUmVwZWF0SHRtbCB7XG4gICAgX29yaWdpbmFsRWxlbWVudHM6IGFueTtcbiAgICBfc2NvcGU6IGFueTtcbiAgICBfZmlsdGVycztcbiAgICBSRVBFQVRfQVRUUl9OQU1FOiBhbnk7XG5cbiAgICBjb25zdHJ1Y3Rvcihjb25maWc6IGFueSA9IHt9KSB7XG4gICAgICAgIHRoaXMuUkVQRUFUX0FUVFJfTkFNRSA9IGNvbmZpZy5hdHRyTmFtZSB8fCAncmVwZWF0JztcbiAgICAgICAgdGhpcy5fZmlsdGVycyA9IHt9O1xuICAgICAgICB0aGlzLl9zY29wZSA9IGNvbmZpZy5zY29wZSB8fCB7fTtcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxFbGVtZW50cyA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5zZWFyY2hGaWx0ZXJzKCk7XG5cbiAgICAgICAgaWYgKGNvbmZpZy5jb21waWxlIHx8IGNvbmZpZy5jb21waWxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGluaXQuY2FsbCh0aGlzLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWV0b2RvIGRlIGVudHJhZGEgbyBzYWxpZGEgZGUgZGF0b3MgZGVsIF9zY29wZVxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAbWV0aG9kXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFyTmFtZSAtIE5vbWJyZSBkZWwgZGF0byBhIGFsbWFjZW5hciBkZW50cm8gZGVsIHNjb3BlXG4gICAgICogQHBhcmFtIHthbnlbXX0gZGF0YSAtIEluZm9ybWFjaW9uIG8gZGF0b3MgYSBhbG1hY2VuYXJcbiAgICAgKiBAcGFyYW0ge09iamVjdHxGdW5jdGlvbnxBcnJheX0gZnVuY0JhY2tzIC0gRnVuY2lvbmVzIHF1ZSBzZSBlamVjdXRhcmFuIGFsIGFjdHVhbGl6YXIgZWwgbW9kZWxvIGRlIGRhdG9zXG4gICAgICovXG4gICAgc2NvcGUodmFyTmFtZTogc3RyaW5nLCBkYXRhLCBmdW5jQmFja3M/KSB7XG4gICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY29wZVt2YXJOYW1lXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3Njb3BlW3Zhck5hbWVdID0gdGhpcy5fc2NvcGVbdmFyTmFtZV0gfHwge307XG4gICAgICAgIHRoaXMuX3Njb3BlW3Zhck5hbWVdLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLl9zY29wZVt2YXJOYW1lXS5vcmlnaW5hbERhdGEgPSBkYXRhO1xuXG4gICAgICAgIGlmICh0eXBlb2YgZnVuY0JhY2tzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLl9zY29wZVt2YXJOYW1lXS5mdW5jQmFja0FmdGVyID0gZnVuY0JhY2tzO1xuICAgICAgICB9IGVsc2UgaWYgKGlzT2ZUeXBlKGZ1bmNCYWNrcywgJ2FycmF5JykpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njb3BlW3Zhck5hbWVdLmZ1bmNCYWNrQWZ0ZXIgPSBmdW5jQmFja3NbMF07XG4gICAgICAgICAgICB0aGlzLl9zY29wZVt2YXJOYW1lXS5mdW5jQmFjayA9IGZ1bmNCYWNrc1sxXTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZnVuY0JhY2tzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdGhpcy5fc2NvcGVbdmFyTmFtZV0uZnVuY0JhY2tBZnRlciA9IGZ1bmNCYWNrcy5hZnRlcjtcbiAgICAgICAgICAgIHRoaXMuX3Njb3BlW3Zhck5hbWVdLmZ1bmNCYWNrID0gZnVuY0JhY2tzLmZ1bmNCYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoKHZhck5hbWUpO1xuXG4gICAgICAgIGlmICh0aGlzLl9zY29wZVt2YXJOYW1lXS5mdW5jQmFja0FmdGVyKSB7XG4gICAgICAgICAgICB0aGlzLl9zY29wZVt2YXJOYW1lXS5mdW5jQmFja0FmdGVyLmNhbGwodGhpcywgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge2FueX0gdmFyaWFibGVOYW1lXG4gICAgICogQHBhcmFtIHthbnl9IGZpbHRlclZhbHVlXG4gICAgICogQHBhcmFtIHthbnl9IGVsZW1lbnRcbiAgICAgKiBAcmV0dXJuc1xuICAgICAqL1xuICAgIGZpbHRlcih2YXJpYWJsZU5hbWU6IHN0cmluZywgZmlsdGVyVmFsdWUsIGVsZW1lbnQpIHtcbiAgICAgICAgZmlsdGVyVmFsdWUgPSBmaWx0ZXJWYWx1ZS50cmltKCk7XG5cbiAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVGaWx0ZXIodmFyaWFibGVOYW1lLCBmaWx0ZXJWYWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBfZmlsdGVyID0gZmlsdGVyVmFsdWUuc3BsaXQocGF0dGVybnMuZmlsdGVycy5hcyk7XG5cbiAgICAgICAgbGV0IHByb3AgPSBfZmlsdGVyWzBdO1xuICAgICAgICBsZXQgc2VsZWN0b3IgPSBfZmlsdGVyWzFdO1xuXG4gICAgICAgIGlmICghc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHNlbGVjdG9yID0gcHJvcDtcbiAgICAgICAgICAgIHByb3AgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWxlY3Rvci5yZXBsYWNlKC8jfF4lfCUkL2csICcnKSk7XG5cbiAgICAgICAgaWYgKCFlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoYXNQZXJjZW50SW5pdCA9IC9eJS9nLnRlc3Qoc2VsZWN0b3IpID8gJ14nIDogJyc7XG4gICAgICAgIGxldCBoYXNQZXJjZW50RW5kID0gLyUkL2cudGVzdChzZWxlY3RvcikgPyAnJCcgOiAnJztcblxuICAgICAgICBmaWx0ZXJWYWx1ZSA9IGVsZW0udmFsdWU7IC8vcGFyYSBsbGFtYXJsbyB1bmEgcHJpbWVyYSB2ZXpcblxuICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgbGV0IHZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuXG4gICAgICAgICAgICB0aGlzLl9zY29wZVt2YXJpYWJsZU5hbWVdLmRhdGEgPSB0aGlzLl9zY29wZVtcbiAgICAgICAgICAgICAgICB2YXJpYWJsZU5hbWVcbiAgICAgICAgICAgIF0ub3JpZ2luYWxEYXRhLmZpbHRlcihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhdHRlcm4gPSBuZXcgUmVnRXhwKFxuICAgICAgICAgICAgICAgICAgICBoYXNQZXJjZW50SW5pdCArIHZhbHVlICsgaGFzUGVyY2VudEVuZCxcbiAgICAgICAgICAgICAgICAgICAgJ2dpJ1xuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJvcCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybi50ZXN0KGRhdGFbcHJvcF0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgX3Byb3AgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGRhdGFbX3Byb3BdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKHZhcmlhYmxlTmFtZSwgZWxlbWVudCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHNlYXJjaEZpbHRlcnMoKSB7XG4gICAgICAgIGxldCBxdWVyeUZpbHRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1maWx0ZXJdJyk7XG5cbiAgICAgICAgaWYgKHF1ZXJ5RmlsdGVycy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGVsZW1lbnQgPSBudWxsO1xuICAgICAgICBsZXQgcXVlcnlSZXBlYXQgPSAnJztcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgKGVsZW1lbnQgPSBxdWVyeUZpbHRlcnNbaV0pOyBpKyspIHtcbiAgICAgICAgICAgIHF1ZXJ5UmVwZWF0ID0gZWxlbWVudC5kYXRhc2V0W3RoaXMuUkVQRUFUX0FUVFJfTkFNRV0uc3BsaXQoXG4gICAgICAgICAgICAgICAgcGF0dGVybnMuc3BsaXRRdWVyeVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZWxlbWVudC5kYXRhc2V0LmZpbHRlclxuICAgICAgICAgICAgICAgIC5zcGxpdChwYXR0ZXJucy5zcGxpdFF1ZXJ5VmFycylcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmaWx0ZXIgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcihxdWVyeVJlcGVhdFsxXSwgZmlsdGVyLCBlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbHRyYXIgbGEgbGlzdGEgZGUgZGF0b3MgZGVwZW5kaWVuZG8gZGVsIHBhcmFtZXRybyBkYWRvXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBtZXRob2RcbiAgICAgKi9cbiAgICBhcHBseUZpbHRlcih2YXJOYW1lKSB7XG4gICAgICAgIGlmICghdmFyTmFtZSB8fCAhdGhpcy5fZmlsdGVyc1t2YXJOYW1lXSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY29wZVt2YXJOYW1lXS5kYXRhO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9zY29wZVt2YXJOYW1lXS5kYXRhLmZpbHRlcih0aGlzLl9maWx0ZXJzW3Zhck5hbWVdKTtcbiAgICB9XG5cbiAgICB2YWxpZGF0ZUZpbHRlcih2YXJpYWJsZU5hbWU6IHN0cmluZywgZmlsdGVyVmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodmFyaWFibGVOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFwYXR0ZXJucy5maWx0ZXJzLmFzLnRlc3QoZmlsdGVyVmFsdWUpICYmXG4gICAgICAgICAgICAhcGF0dGVybnMuaGFzU2VsZWN0b3JDc3MudGVzdChmaWx0ZXJWYWx1ZS5yZXBsYWNlKC9eJXwlJC9nLCAnJykpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBsaWNhciBhY2Npb24gZGUgcmVwZXRpclxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAbWV0aG9kXG4gICAgICovXG4gICAgcmVmcmVzaCh2YXJOYW1lLCBlbGVtZW50Pykge1xuICAgICAgICBsZXQgaGFzRGF0YVJlcGVhdEF0dHJpYnV0ZSA9XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS0nICsgdGhpcy5SRVBFQVRfQVRUUl9OQU1FICsgJ10nKVxuICAgICAgICAgICAgICAgIC5sZW5ndGggPiAwO1xuXG4gICAgICAgIGlmIChoYXNEYXRhUmVwZWF0QXR0cmlidXRlKSB7XG4gICAgICAgICAgICBpbml0LmNhbGwodGhpcywgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVSZW5kZXIodmFyTmFtZSwgZWxlbWVudCk7XG5cbiAgICAgICAgLy9jbGVhcigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBpdGFkbyBkZSBsb3MgZGF0b3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBtZXRob2RcbiAgICAgKi9cbiAgICByZVJlbmRlcih2YXJOYW1lLCBlbGVtZW50KSB7XG4gICAgICAgIGxldCBlbGVtZW50cyA9IHRoaXMuX29yaWdpbmFsRWxlbWVudHM7XG4gICAgICAgIGxldCBlbGVtZW50SFRNTCA9ICcnO1xuICAgICAgICBsZXQgcmVwZWF0RGF0YSA9IG51bGw7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBsZXQgbGVuID0gZWxlbWVudHMubGVuZ3RoO1xuICAgICAgICBsZXQgZWxlbWVudERhdGE7XG4gICAgICAgIGxldCBlbGVtZW50c1JlcGVhdENvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICAgICAgbGV0IGZ1bmNCYWNrQXJncyA9IFtdO1xuICAgICAgICBsZXQgbW9kZWxEYXRhID0gdGhpcy5fc2NvcGVbdmFyTmFtZV07XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBlbGVtZW50RGF0YSA9IGVsZW1lbnRzW2ldO1xuXG4gICAgICAgICAgICBpZiAoZWxlbWVudClcbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YXNldC5maWx0ZXIgIT09XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnREYXRhLmVsZW1lbnQuZGF0YXNldC5maWx0ZXJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICByZXBlYXREYXRhID0gcmVzb2x2ZVF1ZXJ5LmNhbGwoXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICBlbGVtZW50RGF0YS5lbGVtZW50LmRhdGFzZXRbdGhpcy5SRVBFQVRfQVRUUl9OQU1FXVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKCFyZXBlYXREYXRhLmRhdGFzIHx8IHZhck5hbWUgIT09IHJlcGVhdERhdGEudmFyTmFtZSkgY29udGludWU7XG5cbiAgICAgICAgICAgIGVsZW1lbnRIVE1MID0gZWxlbWVudERhdGEuZWxlbWVudC5pbm5lckhUTUw7XG5cbiAgICAgICAgICAgIGVsZW1lbnREYXRhLmNoaWxkcy5mb3JFYWNoKGZ1bmN0aW9uKGNoaWxkLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGVsZW1lbnREYXRhLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlbGVtZW50RGF0YS5jaGlsZHMuc3BsaWNlKDEsIGVsZW1lbnREYXRhLmNoaWxkcy5sZW5ndGgpO1xuXG4gICAgICAgICAgICByZXBlYXREYXRhLmRhdGFzLmZvckVhY2goZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGxldCBvYmpEYXRhID0ge307XG4gICAgICAgICAgICAgICAgLy9ObyBzZSBuZWNlc2l0YSBjbG9uYXIgZWwgY29udGVuaWRvIHlhIHF1ZSBlc3RlIHNlcmEgcmVlc2NyaXRvXG4gICAgICAgICAgICAgICAgbGV0IGVsZW1lbnRDbG9uZWQgPSBlbGVtZW50RGF0YS5lbGVtZW50Q2xvbmUuY2xvbmVOb2RlKGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIG9iakRhdGFbcmVwZWF0RGF0YS52YXJzSXRlcmF0ZV0gPSBkYXRhO1xuICAgICAgICAgICAgICAgIGVsZW1lbnRDbG9uZWQuaW5uZXJIVE1MID0gcmVuZGVyVGVtcGxhdGUoZWxlbWVudEhUTUwsIG9iakRhdGEpO1xuXG4gICAgICAgICAgICAgICAgZWxlbWVudHNSZXBlYXRDb250ZW50LmFwcGVuZENoaWxkKGVsZW1lbnRDbG9uZWQpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnREYXRhLmNoaWxkcy5wdXNoKGVsZW1lbnRDbG9uZWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsRGF0YS5mdW5jQmFjaylcbiAgICAgICAgICAgICAgICAgICAgZnVuY0JhY2tBcmdzLnB1c2goW2RhdGEsIGVsZW1lbnRDbG9uZWRdKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbnNlcnRBZnRlcihlbGVtZW50c1JlcGVhdENvbnRlbnQsIGVsZW1lbnREYXRhLmNoaWxkc1swXSk7XG4gICAgICAgICAgICBlbGVtZW50c1JlcGVhdENvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoISF2YXJOYW1lICYmIG1vZGVsRGF0YS5mdW5jQmFjaykge1xuICAgICAgICAgICAgZnVuY0JhY2tBcmdzLmZvckVhY2goYXJncyA9PiB7XG4gICAgICAgICAgICAgICAgbW9kZWxEYXRhLmZ1bmNCYWNrLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogTWV0b2RvIGRlIGVudHJhZGEgbyBzYWxpZGEgZGVsIHNjb3BlXG4gKiBAcHJpdmF0ZVxuICogQG1ldGhvZFxuICovXG5mdW5jdGlvbiBpbml0KGlzUmVmcmVzaCwgZmluZFBhcmVudHMpIHtcbiAgICBsZXQgc2VsZWN0b3IgPSAnW2RhdGEtJyArIHRoaXMuUkVQRUFUX0FUVFJfTkFNRSArICddJztcblxuICAgIGxldCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICAgIHNlbGVjdG9yICsgKGZpbmRQYXJlbnRzID8gJycgOiAnICcgKyBzZWxlY3RvcilcbiAgICApO1xuICAgIGxldCBlbGVtZW50ID0gbnVsbDtcbiAgICBsZXQgcmVwZWF0RGF0YSA9IG51bGw7XG4gICAgbGV0IGk7XG4gICAgbGV0IGxlbjtcbiAgICBsZXQgbGVuRWxlbWVudHMgPSAwO1xuICAgIGxldCBlbGVtZW50c1JlcGVhdENvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cbiAgICBpZiAoIXRoaXMuX29yaWdpbmFsRWxlbWVudHMpIHtcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxFbGVtZW50cyA9IFtdO1xuICAgIH1cblxuICAgIGZvciAoaSA9IDAsIGxlbiA9IGVsZW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGVsZW1lbnQgPSBlbGVtZW50c1tpXS5lbGVtZW50IHx8IGVsZW1lbnRzW2ldO1xuXG4gICAgICAgIHJlcGVhdERhdGEgPSByZXNvbHZlUXVlcnkuY2FsbChcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBlbGVtZW50LmRhdGFzZXRbdGhpcy5SRVBFQVRfQVRUUl9OQU1FXVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghcmVwZWF0RGF0YS5kYXRhcykge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZWxlbWVudEh0bWwgPSBlbGVtZW50LmlubmVySFRNTDtcblxuICAgICAgICBsZXQgZWxlbWVudENvcHkgPSBlbGVtZW50LmNsb25lTm9kZSh0cnVlKSxcbiAgICAgICAgICAgIGNvbW1lbnRTdGFydCA9IGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoXG4gICAgICAgICAgICAgICAgJ1JlcGVhdEhUTUw6IHN0YXJ0KCAnICtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhc2V0W3RoaXMuUkVQRUFUX0FUVFJfTkFNRV0gK1xuICAgICAgICAgICAgICAgICAgICAnICknXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGVsZW1lbnRDb3B5LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS0nICsgdGhpcy5SRVBFQVRfQVRUUl9OQU1FKTtcbiAgICAgICAgZWxlbWVudENvcHkucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZpbHRlcicpO1xuXG4gICAgICAgIGlmICghaXNSZWZyZXNoKSB7XG4gICAgICAgICAgICAvL0FsbWFjZW5hciBjYWRhIGVsZW1lbnRvIG9yaWdpbmFsIGVuIHVuYSBhcnJlZ2xvXG4gICAgICAgICAgICB0aGlzLl9vcmlnaW5hbEVsZW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQuY2xvbmVOb2RlKHRydWUpLFxuICAgICAgICAgICAgICAgIGVsZW1lbnRDbG9uZTogZWxlbWVudENvcHksXG4gICAgICAgICAgICAgICAgcGFyZW50RWxlbWVudDogZWxlbWVudC5wYXJlbnRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGNoaWxkczogW2NvbW1lbnRTdGFydF1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZW5FbGVtZW50cyA9IHRoaXMuX29yaWdpbmFsRWxlbWVudHMubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxlbWVudHNSZXBlYXRDb250ZW50LmFwcGVuZENoaWxkKGNvbW1lbnRTdGFydCk7XG5cbiAgICAgICAgLy9Db21lbnRhcmlvIGRlbGltaXRhZG9yIGRlIGluaWNpb1xuICAgICAgICByZXBlYXREYXRhLmRhdGFzLmZvckVhY2goZGF0YSA9PiB7XG4gICAgICAgICAgICBsZXQgZWxlbWVudENsb25lZCA9IGVsZW1lbnRDb3B5LmNsb25lTm9kZShmYWxzZSk7XG5cbiAgICAgICAgICAgIGVsZW1lbnRDbG9uZWQuaW5uZXJIVE1MID0gcmVuZGVyVGVtcGxhdGUoZWxlbWVudEh0bWwsIHtcbiAgICAgICAgICAgICAgICBbcmVwZWF0RGF0YS52YXJzSXRlcmF0ZV06IGRhdGFcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlbGVtZW50c1JlcGVhdENvbnRlbnQuYXBwZW5kQ2hpbGQoZWxlbWVudENsb25lZCk7XG5cbiAgICAgICAgICAgIGlmICghaXNSZWZyZXNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb3JpZ2luYWxFbGVtZW50c1tsZW5FbGVtZW50cyAtIDFdLmNoaWxkcy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Q2xvbmVkXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZWxlbWVudC5wYXJlbnRFbGVtZW50LnJlcGxhY2VDaGlsZChlbGVtZW50c1JlcGVhdENvbnRlbnQsIGVsZW1lbnQpO1xuICAgICAgICBlbGVtZW50c1JlcGVhdENvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgfVxuXG4gICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpLmxlbmd0aCA+IDAgJiYgIWZpbmRQYXJlbnRzKSB7XG4gICAgICAgIHJldHVybiBpbml0LmNhbGwodGhpcywgaXNSZWZyZXNoLCB0cnVlKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVzdWVsdmUgbGEgY2FkZW5hIGRlIHRleHRvIGRlbCByZXBlYXQgYSBkb3MgcHJvcGllZGFkZXNcbiAqIEBwcml2YXRlXG4gKiBAbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIHJlc29sdmVRdWVyeShxdWVyeSkge1xuICAgIHF1ZXJ5ID0gcXVlcnkuc3BsaXQocGF0dGVybnMuc3BsaXRRdWVyeSk7XG5cbiAgICBpZiAocXVlcnlbMF0udHJpbSgpID09PSAnJyAmJiAhcXVlcnlbMV0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhcnNJdGVyYXRlOiBudWxsLFxuICAgICAgICAgICAgZGF0YXM6IG51bGwsXG4gICAgICAgICAgICB2YXJOYW1lOiBudWxsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdmFyc0l0ZXJhdGU6IHF1ZXJ5WzBdLnNwbGl0KHBhdHRlcm5zLnNwbGl0UXVlcnlWYXJzKSxcbiAgICAgICAgZGF0YXM6IHBhcnNlRGF0YS5jYWxsKHRoaXMsIHF1ZXJ5WzFdLnRyaW0oKSksXG4gICAgICAgIHZhck5hbWU6IHF1ZXJ5WzFdLnRyaW0oKVxuICAgIH07XG59XG5cbi8qKlxuICogSW5qZWN0b3IgZGUgZGF0b3MgZGVudHJvIGRlIHVuIHRlbXBsYXRlKGNhZGVuYSBkZSB0ZXh0bylcbiAqIEBwcml2YXRlXG4gKiBAbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIHJlbmRlclRlbXBsYXRlKHRlbXBsYXRlLCBkYXRhcykge1xuICAgIHJldHVybiB0ZW1wbGF0ZVxuICAgICAgICAucmVwbGFjZShwYXR0ZXJucy5rZXlUeXBlQXJyYXksICcuJDEnKVxuICAgICAgICAucmVwbGFjZShwYXR0ZXJucy5maW5kVGVtcGxhdGVWYXJzLCBmdW5jdGlvbihmaW5kLCBrZXkpIHtcbiAgICAgICAgICAgIGxldCBwYXJ0c0tleSA9IGtleS5zcGxpdCgnLicpO1xuICAgICAgICAgICAgbGV0IGZpbmRlciA9IGRhdGFzW3BhcnRzS2V5WzBdXTtcbiAgICAgICAgICAgIGxldCBpZHg7XG5cbiAgICAgICAgICAgIGZvciAoaWR4ID0gMTsgaWR4IDwgcGFydHNLZXkubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgICAgIGZpbmRlciA9IGZpbmRlcltwYXJ0c0tleVtpZHhdXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZpbmRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaW5kZXI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmaW5kO1xuICAgICAgICB9KTtcbn1cblxuLyoqXG4gKiBDb2RpZmljYSBsb3MgZGF0b3MgZGUgZW50cmFkYSBkZXBlbmRpZW5kbyBkZWwgdGlwbywgYXJyYXkgbyBzdHJpbmdcbiAqIEBwcml2YXRlXG4gKiBAbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIHBhcnNlRGF0YShzdHJEYXRhKSB7XG4gICAgaWYgKHRoaXMuX3Njb3BlW3N0ckRhdGFdKSByZXR1cm4gdGhpcy5hcHBseUZpbHRlcihzdHJEYXRhKTtcblxuICAgIGlmIChcbiAgICAgICAgcGF0dGVybnMuaXNBcnJheVNpbnRheC5pbmkudGVzdChzdHJEYXRhKSAmJlxuICAgICAgICBwYXR0ZXJucy5pc0FycmF5U2ludGF4LmVuZC50ZXN0KHN0ckRhdGEpXG4gICAgKVxuICAgICAgICByZXR1cm4gZXZhbChzdHJEYXRhKTtcblxuICAgIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIFV0aWxzXG4gKi9cbmZ1bmN0aW9uIGluc2VydEFmdGVyKGluc2VydEVsZW1lbnQsIGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5uZXh0U2libGluZykge1xuICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGluc2VydEVsZW1lbnQsIGVsZW1lbnQubmV4dFNpYmxpbmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5hcHBlbmRDaGlsZChpbnNlcnRFbGVtZW50KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGlzT2ZUeXBlKGRhdGEsIGNvbXBhcmUpIHtcbiAgICByZXR1cm4gKFxuICAgICAgICB7fS50b1N0cmluZ1xuICAgICAgICAgICAgLmNhbGwoZGF0YSlcbiAgICAgICAgICAgIC5tYXRjaCgvXFxzKC4rKVxcXSQvKVsxXVxuICAgICAgICAgICAgLnRvTG93ZXJDYXNlKCkgPT09IGNvbXBhcmVcbiAgICApO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==